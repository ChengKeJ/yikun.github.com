title    : 从WorldCount开始
category : Hadoop
tags     : 
date     : 2014-09-21
---

WordCount是Hadoop的Hello World，

其实，基于MapReduce的WordCount的过程应该在大家的生活中早已经遇到了。还记得你参与过的班干部选举吗？是不是让我们每一个人写一个纸,然后可能会让大家按宿舍统计好，然后交给班长，然后班长把各个候选人的投票都统计出来，然后公布出来。

那么我们就分析一下这个投票的过程。首先

1. 宿舍长统计阶段。
1.1 了解宿舍成员投票(Read)
1.2 整理各个宿舍成员投票(Map)
1.3 将投票结果记在脑子里(Collect)
1.4 由于投票人太多，记不住了，所以记在纸上(Spill)
1.5 将宿舍的投票结果做一次汇总(Combine)
这个阶段开始的时候，各个宿舍成员(小x)每个投票，然后宿舍长把各个结果合并(Merge)给宿舍长，我们可以得到下面的结果：

		A宿舍：
			张三 1
			李四 1
			王五 1
			张三 1
			王五 1
			王五 1
			李四 1
			张三 1

这时候，有些宿舍长可能会比较勤快，把宿舍8位同学的投票结果做了下组合(Combiner)，结果如下所示：

		A宿舍：
			张三 3
			王五 3
			李四 2

这样，宿舍长把统计的结果告诉班长，然后班长就开始他自己的工作了

2. 班长投票统计阶段。
班长拿到各个宿舍的名单之后，开始做汇总的工作。

		A宿舍：
			张三 3
			王五 3
			李四 2
		B宿舍：
			张三 2
			王五 2
			李四 4

假设就2个宿舍，那么班长通过自己的计算以后，得到最后的投票结果：

		李四 6
		张三 5
		王五 5

最终李四以一票只差赢得了选举，变成了一名班干部。

1.Map Combiner Reduce什么作用？
最近看到一个新闻，苏格兰独立公投，英国人投票都是在写“1”。然后，我们脑海中不难出现一个即视感很强的画面，统计人员在辛辛苦地数“1”，这个时候我们就要感谢中国古代人民的智慧了，把5个“1”变成一个“正”字，这样我们在最后统计汇总的时候，也很方便。

